{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap c2339cd4287038219a91","webpack:///./src/index.js","webpack:///external \"firebase\"","webpack:///external {\"root\":\"_\",\"amd\":\"lodash\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\"}","webpack:///external \"updeep\"","webpack:///./~/google-analytics-js/gajs.js"],"names":[],"mappings":"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","file":"index.browser.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"firebase\"), require(\"lodash\"), require(\"updeep\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"firedux\", [\"firebase\", \"lodash\", \"updeep\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"firedux\"] = factory(require(\"firebase\"), require(\"lodash\"), require(\"updeep\"));\n\telse\n\t\troot[\"firedux\"] = factory(root[\"firebase\"], root[\"_\"], root[\"updeep\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c2339cd4287038219a91","import Firebase from 'firebase'\nimport _ from 'lodash'\nimport updeep from 'updeep'\nimport gaTrack from 'google-analytics-js'\n// import _debug from 'debug'\n// const debug = _// debug('firedux')\n\nif (typeof window !== 'undefined') {\n  if (!(window.FIREDUX_OPTIONS && window.FIREDUX_OPTIONS.noTrack)) {\n    gaTrack('UA-82065077-1', 'github.com', '/AndersDJohnson/firedux/src/index.js')\n  }\n}\n\nconst localStorage = typeof window === 'object' ? window.localStorage : null\n\nconst initialState = {\n  data: {}\n}\n\nfunction splitUrl (url) {\n  return url.split(/\\//)\n}\n\n// function urlToKeyPath (url) {\n//   const keyPath = splitUrl(url).join('.')\n//   return keyPath\n// }\n\nexport default class Firedux {\n  constructor (options) {\n    const that = this\n    if (options.url) {\n      console.warn('Firedux option \"url\" is deprecated, use \"ref\" instead.')\n    }\n    this.url = options.url || options.ref.toString()\n    this.ref = options.ref || new Firebase(this.url)\n    if (this.url.slice(-1) !== '/') {\n      this.url += '/'\n    }\n    this.omit = options.omit || []\n    this.token = null\n    this.getting = {}\n    this.removing = {}\n    this.watching = {}\n    this.actionId = 0\n    this.dispatch = null\n\n    function makeFirebaseState (action, state, path, value, merge = false) {\n      // const keyPath = urlToKeyPath(path)\n      // const dataPath = 'data.' + keyPath\n      const dataPath = ['data'].concat(splitUrl(path))\n      // const statusPath = 'status.' + keyPath\n      // debug('MAKE FIREBASE STATE FOR ACTION', action.type, 'VALUE', keyPath, value, 'merge', merge)\n      value = merge ? value : updeep.constant(value)\n      const newState = updeep.updateIn(dataPath, value, state)\n      return newState\n    }\n\n    function removeFirebaseState (action, state, path) {\n      const split = splitUrl(path)\n      const dataSplit = ['data'].concat(split)\n\n      // get & set value for restore in case of error\n      // TODO: Find a cleaner way to do this.\n      action.setValue(_.get(state, dataSplit))\n\n      const id = split.pop()\n      const parentPath = split.join('.')\n      that.ref.child(path).off()\n      const keyPath = parentPath\n      const dataPath = 'data.' + keyPath\n      const newState = updeep.updateIn(dataPath, updeep.omit(id), state)\n      return newState\n    }\n\n    this.reducer = function reducer () {\n      return function (state = initialState, action) {\n        // debug('FIREBASE ACTION', action.type, action)\n        switch (action.type) {\n          case 'FIREBASE_GET':\n          case 'FIREBASE_WATCH':\n            return makeFirebaseState(action, state, action.path, action.snapshot.val())\n          case 'FIREBASE_SET':\n          case 'FIREBASE_PUSH':\n            return makeFirebaseState(action, state, action.path, action.value)\n          case 'FIREBASE_UPDATE':\n            return makeFirebaseState(action, state, action.path, action.value, true)\n          case 'FIREBASE_REMOVE':\n            return removeFirebaseState(action, state, action.path)\n          case 'FIREBASE_SET_RESPONSE':\n          case 'FIREBASE_UPDATE_RESPONSE':\n          case 'FIREBASE_REMOVE_RESPONSE':\n            // TODO: Error handling, at per-path level, somehow async without clobber, maybe queues?\n            if (action.error) {\n              console.error(action.error)\n              // restore state\n              return makeFirebaseState(action, state, action.path, action.value)\n            }\n            return state\n          case 'FIREBASE_PUSH_RESPONSE':\n            if (action.error) {\n              // return removeFirebaseState(action, state, action.path)\n            }\n            return state\n          case 'FIREBASE_LOGIN':\n          case 'FIREBASE_LOGOUT':\n          case 'FIREBASE_LOGIN_ERROR':\n            return updeep({\n              authData: action.authData,\n              authError: action.error\n            }, state)\n          default:\n            return state\n        }\n      }\n    }\n\n    return this\n  }\n  cleanValue (value) {\n    return _.isObject(value) ? _.omit(value, this.omit) : value\n  }\n  init () {\n    const { dispatch } = this\n    const that = this\n    return new Promise((resolve, reject) => {\n      this.token = localStorage.getItem('FIREBASE_TOKEN')\n      if (this.token) {\n        resolve(this.login(dispatch, {\n          token: this.token\n        }))\n      }\n\n      // listen for auth changes\n      if (_.isFunction(this.ref.onAuth)) {\n        this.ref.onAuth(function (authData) {\n          // debug('FB AUTH DATA', authData)\n          if (!authData) {\n            localStorage.removeItem('FIREBASE_TOKEN')\n            that.authData = null\n            dispatch({type: 'FIREBASE_LOGOUT'})\n            reject()\n          }\n          resolve(authData)\n        })\n      }\n    })\n  }\n  login (credentials) {\n    const { dispatch } = this\n    const that = this\n    return new Promise((resolve, reject) => {\n      dispatch({type: 'FIREBASE_LOGIN_ATTEMPT'})\n\n      const handler = function (error, authData) {\n        // TODO: Error handling.\n        // debug('FB AUTH', error, authData)\n        if (error) {\n          console.error('FB AUTH ERROR', error, authData)\n          dispatch({type: 'FIREBASE_LOGIN_ERROR', error})\n          reject(error)\n          return\n        }\n        localStorage.setItem('FIREBASE_TOKEN', authData.token)\n        that.authData = authData\n        dispatch({type: 'FIREBASE_LOGIN', authData: authData, error: error})\n        resolve(authData)\n      }\n\n      try {\n        if (credentials.token) {\n          this.ref.authWithCustomToken(this.token, handler)\n        } else {\n          this.ref.authWithPassword(credentials, handler)\n        }\n      } catch (error) {\n        console.error('FB AUTH ERROR', error)\n        dispatch({type: 'FIREBASE_LOGIN_ERROR', error})\n        reject(error)\n      }\n    })\n  }\n  logout () {\n    const { dispatch } = this\n    return new Promise((resolve, reject) => {\n      dispatch({type: 'FIREBASE_LOGOUT_ATTEMPT'})\n      this.ref.unauth()\n      this.authData = null\n      this.authError = null\n      dispatch({type: 'FIREBASE_LOGOUT'})\n      resolve()\n    })\n  }\n  watch (path, onComplete) {\n    const { dispatch } = this\n    return new Promise((resolve) => {\n      if (this.watching[path]) {\n        // // debug('already watching', path)\n        return false\n      }\n      this.watching[path] = true\n      // debug('DISPATCH WATCH', path)\n      this.ref.child(path).on('value', snapshot => {\n        // debug('GOT WATCHED VALUE', path, snapshot.val())\n        // TODO: Make watches smart enough to ignore pending updates, e.g. not replace\n        //  a path that has been removed locally but is queued for remote delete?\n        dispatch({\n          type: 'FIREBASE_WATCH',\n          path: path,\n          snapshot: snapshot\n        })\n\n        if (onComplete) onComplete(snapshot)\n        resolve({snapshot: snapshot})\n      })\n    })\n  }\n  get (path, onComplete) {\n    const { dispatch } = this\n    return new Promise((resolve) => {\n      if (this.getting[path]) {\n        // debug('already getting', path)\n        return { type: 'FIREBASE_GET_PENDING' }\n      }\n      this.getting[path] = true\n      // debug('FB GET', path)\n      this.ref.child(path).once('value', snapshot => {\n        this.getting[path] = false\n        dispatch({\n          type: 'FIREBASE_GET',\n          path: path,\n          snapshot: snapshot\n        })\n        if (onComplete) onComplete(snapshot)\n        resolve({snapshot: snapshot})\n      })\n    })\n  }\n  set (path, value, onComplete) {\n    const { dispatch } = this\n    return new Promise((resolve, reject) => {\n      const newValue = this.cleanValue(value)\n      // debug('FB SET', path, newValue)\n      // optimism\n      dispatch({\n        type: 'FIREBASE_SET',\n        path: path,\n        value: newValue\n      })\n      this.ref.child(path).set(newValue, error => {\n        dispatch({\n          type: 'FIREBASE_SET_RESPONSE',\n          path: path,\n          value: newValue,\n          error: error\n        })\n        if (onComplete) onComplete(error)\n        if (error) reject(error)\n        else resolve({value: newValue})\n      })\n    })\n  }\n  update (path, value, onComplete) {\n    const { dispatch } = this\n    return new Promise((resolve, reject) => {\n      const newValue = this.cleanValue(value)\n      // debug('FB UPDATE', path, newValue)\n      // optimism\n      dispatch({\n        type: 'FIREBASE_UPDATE',\n        path: path,\n        value: newValue\n      })\n      this.ref.child(path).update(newValue, error => {\n        dispatch({\n          type: 'FIREBASE_UPDATE_RESPONSE',\n          path: path,\n          value: newValue,\n          error: error\n        })\n        if (onComplete) onComplete(error)\n        if (error) reject(error)\n        else resolve({value: newValue})\n      })\n    })\n  }\n  remove (path, onComplete) {\n    const { dispatch } = this\n    return new Promise((resolve, reject) => {\n      if (this.removing[path]) {\n        // debug('already removing', path)\n        return { type: 'FIREBASE_REMOVE_PENDING' }\n      }\n      this.removing[path] = true\n      // debug('FB remove', path)\n\n      let value\n\n      // optimism\n      dispatch({\n        type: 'FIREBASE_REMOVE',\n        path: path,\n        // TODO: How to access state for cleaner rollback?\n        // eslint-disable-next-line no-return-assign\n        setValue: (v) => value = v\n      })\n      this.ref.child(path).remove((error) => {\n        this.removing[path] = false\n        dispatch({\n          type: 'FIREBASE_REMOVE_RESPONSE',\n          path: path,\n          value: value,\n          error: error\n        })\n        if (onComplete) onComplete(error)\n        if (error) reject(error)\n        else resolve()\n      })\n    })\n  }\n  push (toPath, value, onId, onComplete) {\n    const { dispatch } = this\n    const that = this\n    const newValue = this.cleanValue(value)\n\n    return new Promise((resolve, reject) => {\n      // debug('FB PUSH', toPath, newValue)\n\n      let path, newId\n      const ref = that.ref.child(toPath)\n      const pushRef = ref.push(newValue, (error) => {\n        dispatch({\n          type: 'FIREBASE_PUSH_RESPONSE',\n          path: path,\n          toPath: toPath,\n          newId: newId,\n          value: newValue,\n          error: error\n        })\n        if (onComplete) onComplete(error, newId)\n        if (error) reject(error)\n        else resolve(newId)\n      })\n      path = pushRef.toString().replace(that.url, '')\n      // function in firebase@2, property in firebase@3\n      newId = _.isFunction(pushRef, 'key') ? pushRef.key() : pushRef.key\n      if (onId) onId(newId)\n\n      // optimism\n      dispatch({\n        type: 'FIREBASE_PUSH',\n        path: path,\n        toPath: toPath,\n        newId: newId,\n        value: newValue,\n        ref: pushRef,\n        toRef: ref\n      })\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"firebase\"\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"_\",\"amd\":\"lodash\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\"}\n// module id = 2\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"updeep\"\n// module id = 3\n// module chunks = 0","// https://github.com/umdjs/umd/blob/master/templates/returnExportsGlobal.js\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], function () {\n            return (root.gaTrack = factory());\n        });\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    } else {\n        // Browser globals\n        root.gaTrack = factory();\n    }\n}(this, function () {\n    /**\n     * Google Analytics JS v1\n     * http://code.google.com/p/google-analytics-js/\n     * Copyright (c) 2009 Remy Sharp remysharp.com / MIT License\n     * $Date: 2009-02-25 14:25:01 +0000 (Wed, 25 Feb 2009) $\n     */\n    function gaTrack(urchinCode, domain, url) {\n        function rand(min, max) {\n            return min + Math.floor(Math.random() * (max - min));\n        }\n        \n        if (!this.Image) return;\n\n        var i=1000000000,\n            utmn=rand(i,9999999999), //random request number\n            cookie=rand(10000000,99999999), //random cookie number\n            random=rand(i,2147483647), //number under 2147483647\n            today=(new Date()).getTime(),\n            win = this.location,\n            img = new this.Image(),\n            urchinUrl = 'https://www.google-analytics.com/__utm.gif?utmwv=1.3&utmn='\n                +utmn+'&utmsr=-&utmsc=-&utmul=-&utmje=0&utmfl=-&utmdt=-&utmhn='\n                +domain+'&utmr='+win+'&utmp='\n                +url+'&utmac='\n                +urchinCode+'&utmcc=__utma%3D'\n                +cookie+'.'+random+'.'+today+'.'+today+'.'\n                +today+'.2%3B%2B__utmb%3D'\n                +cookie+'%3B%2B__utmc%3D'\n                +cookie+'%3B%2B__utmz%3D'\n                +cookie+'.'+today\n                +'.2.2.utmccn%3D(referral)%7Cutmcsr%3D' + win.host + '%7Cutmcct%3D' + win.pathname + '%7Cutmcmd%3Dreferral%3B%2B__utmv%3D'\n                +cookie+'.-%3B';\n\n        // trigger the tracking\n        img.src = urchinUrl;\n    }\n\n    return gaTrack;\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/google-analytics-js/gajs.js\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}
